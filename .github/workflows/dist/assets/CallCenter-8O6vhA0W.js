import{d as c,s as i,y as d,a as r,c as l,b as n,_ as p}from"./index-Dk3O8imR.js";const m={class:"video-layout"},u=c({__name:"CallCenter",setup(f){let t=i();const s=new RTCPeerConnection;s.addEventListener("icecandidate",async e=>{e.candidate&&t.sendMessage("iceCandidate",["callCenter"],JSON.stringify(e.candidate))}),d(()=>t.messageRespond.service,async e=>{e==="iceCandidate"?await s.addIceCandidate(JSON.parse(t.messageRespond.message)):e==="sdp"&&o(JSON.parse(t.messageRespond.message))}),s.addEventListener("iceconnectionstatechange",e=>{console.log("pc2: iceconnectionstatechange",e)}),s.addEventListener("track",e=>{e.streams.length>0&&(remoteVideo.srcObject=e.streams[0])});async function o(e){s.setRemoteDescription(e);const a=await s.createAnswer();s.setLocalDescription(a),console.warn("answer",a),t.sendMessage("sdp",["callCenter"],JSON.stringify(a))}return window.onload=async()=>{document.querySelector("#remoteVideo"),document.querySelector("#localVideo")},(e,a)=>(r(),l("div",m,a[0]||(a[0]=[n("h1",null," this is a 接收方 video",-1),n("video",{class:"video",id:"remoteVideo",autoplay:""},null,-1),n("video",{class:"video",id:"localVideo",autoplay:""},null,-1)])))}}),_=p(u,[["__scopeId","data-v-0b86f22b"]]);export{_ as default};
